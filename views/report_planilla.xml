<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="report_planilla_document">
            <t t-call="web.html_container">
                <t t-as="o" t-foreach="docs">
                    <div class="page">
                        <style>table, td, th {
              border: 1px solid black; 
              text-align:center;
              font-size: 12px; 
            }

            table {
              border-collapse: collapse;
              width: 100%;
            }

            td {
              vertical-align: center;
              font-size: 14px; 
            }
          </style>
                        <center>
                            <h2>Planilla 
                            
                            
                            
                                <t t-esc="o.fecha_inicio"/>
                                al 
                            
                            
                            
                                <t t-esc="o.fecha_final"/></h2>
                        </center>
                        <div style="height: 40px;"/>
                        <!-- Variables -->
                        <t t-set="total_rebajos" t-value="0"/>
                        <t t-set="total_ccss" t-value="0"/>
                        <t t-set="total_salario_base" t-value="0"/>
                        <t t-set="total_ausencias" t-value="0"/>
                        <t t-set="total_feriados" t-value="0"/>
                        <t t-set="total_bonificaciones" t-value="0"/>
                        <t t-set="sobre" t-value="0"/>
                        <table>
                            <tr>
                                <th>Sobre</th>
                                <th>Empleado </th>
                                <th>Salario Base </th>
                                <th>Ausencias </th>
                                <th>Feriados </th>
                                <th>Rebajos</th>
                                <th>Bonificaciones </th>
                                <th>Seguro </th>
                                <th>Salario Neto </th>
                            </tr>
                            <t t-as="i" t-foreach="o.calculo_salario_ids.sorted(key=lambda b: b.empleado_id.name)">
                                <t t-set="total_salario_base" t-value="total_salario_base + i.empleado_id.salario"/>
                                <t t-set="total_ccss" t-value="total_ccss + i.empleado_id.ccss"/>
                                <t t-set="total_rebajos" t-value="total_rebajos + i.rebajos"/>
                                <t t-set="total_ausencias" t-value="total_ausencias + i.ausencias"/>
                                <t t-set="total_feriados" t-value="total_feriados + i.feriados"/>
                                <t t-set="total_bonificaciones" t-value="total_bonificaciones + i.bonificaciones"/>
                                <t t-if=" i.total_salario &gt;0 ">
                                    <t t-set="sobre" t-value="sobre + 1"/>
                                    <tr>
                                        <td>
                                            <t t-esc="sobre"/>
                                        </td>
                                        <td style="text-align:left">
                                            <t t-esc="i.empleado_id.name"/>
                                        </td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.salario))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.ausencias))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.feriados))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.rebajos))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.bonificaciones))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.ccss))"/></td>
                                        <td>₡ 
                                            
                                        
                                        
                                        
                                            <t t-esc="'{0:,.2f}'.format(int(i.total_salario))"/></td>
                                    </tr>
                                </t>
                            </t>
                            <tr>
                                <th colspan="2">Total </th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_salario_base))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_ausencias))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_feriados))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_rebajos))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_bonificaciones))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_ccss))"/></th>
                                <th>₡ 
                                
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(o.total_planilla))"/></th>
                            </tr>
                        </table>
                        <div style="height: 40px;"/>
                        <!-- Variables Resumen Prestamos -->
                        <t t-set="total_prestamos" t-value="0"/>
                        <t t-set="total_abonos" t-value="0"/>
                        <t t-set="total_saldos" t-value="0"/>
                        <table>
                            <tr>
                                <th colspan="8" style="text-align:center">Resumen de Prestamos </th>
                            </tr>
                            <tr>
                                <th>Empleado </th>
                                <th>Monto </th>
                                <th>Abono </th>
                                <th>Saldo </th>
                            </tr>
                            <t t-as="i" t-foreach="o.calculo_salario_ids.sorted(key=lambda b: b.empleado_id.name)">
                                <t t-if="i.saldo_prestamo &gt;0 ">
                                    <t t-set="total_prestamos" t-value="total_prestamos + i.monto_prestamo"/>
                                    <t t-set="total_abonos" t-value="total_abonos + i.prestamos"/>
                                    <t t-set="total_saldos" t-value="total_saldos + i.saldo_prestamo"/>
                                    <t t-if=" i.saldo_prestamo &gt;0 ">
                                        <tr>
                                            <td style="text-align:left">
                                                <t t-esc="i.empleado_id.name"/>
                                            </td>
                                            <td>₡ 
                                            
                                            
                                            
                                                <t t-esc="'{0:,.2f}'.format(int(i.monto_prestamo))"/></td>
                                            <td>₡ 
                                            
                                            
                                            
                                                <t t-esc="'{0:,.2f}'.format(int(i.prestamos))"/></td>
                                            <td>₡ 
                                            
                                            
                                            
                                                <t t-esc="'{0:,.2f}'.format(int(i.saldo_prestamo))"/></td>
                                        </tr>
                                    </t>
                                </t>
                            </t>
                            <tr>
                                <th>Total </th>
                                <th>₡ 
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_prestamos))"/></th>
                                <th>₡ 
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_abonos))"/></th>
                                <th>₡ 
                                
                                
                                
                                    <t t-esc="'{0:,.2f}'.format(int(total_saldos))"/></th>
                            </tr>
                        </table>
                    </div>
                </t>
            </t>
        </template>
    </data>
</openerp>